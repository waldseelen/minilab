{% extends 'base.html' %}

{% block extra_css %}
<style>
    /* Kitap parlamasÄ± */
    .book-glow {
        box-shadow: 0 0 60px rgba(139, 92, 246, 0.3);
    }

    /* Sayfa Ã§evirme animasyonu */
    @keyframes page-turn {
        0%, 100% { transform: rotateY(0deg); }
        50% { transform: rotateY(-5deg); }
    }

    .page-animate:hover {
        animation: page-turn 0.5s ease-in-out;
    }
</style>
{% endblock %}

{% block content %}
<div class="min-h-screen py-8" x-data="storyDetailPage()">
    <div class="max-w-4xl mx-auto px-4">

        <!-- Breadcrumb -->
        <nav class="mb-6">
            <ol class="flex items-center gap-2 text-sm bg-white/60 dark:bg-gray-800/60 backdrop-blur-sm rounded-full px-4 py-2 w-fit">
                <li><a href="{% url 'dashboard:child_dashboard' %}" class="text-minilab-blue-500 hover:underline">ğŸ  Ana Sayfa</a></li>
                <li class="text-gray-400">â€º</li>
                <li><a href="{% url 'storymode:story_list' %}" class="text-minilab-blue-500 hover:underline">ğŸ“– Hikayeler</a></li>
                <li class="text-gray-400">â€º</li>
                <li class="text-gray-600 dark:text-gray-300 font-bold">{{ story.title }}</li>
            </ol>
        </nav>

        <!-- Hikaye DetayÄ± -->
        <div class="card-cute book-glow mb-8 text-center overflow-hidden">

            <!-- Kapak AlanÄ± -->
            <div class="relative -mx-6 -mt-6 mb-8 h-48 bg-gradient-to-br from-minilab-purple via-minilab-pink to-minilab-blue-400 flex items-center justify-center">
                {% if story.cover_image %}
                <img src="{{ story.cover_image.url }}" alt="{{ story.title }}" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"></div>
                {% endif %}
                <div class="absolute inset-0 flex items-center justify-center">
                    <span class="text-9xl animate-float drop-shadow-lg">ğŸ“š</span>
                </div>
            </div>

            <h1 class="font-display text-4xl text-minilab-purple mb-4">{{ story.title }}</h1>

            <!-- Dinle Butonu -->
            <button @click="speakDescription()"
                    class="inline-flex items-center gap-2 bg-minilab-purple/10 hover:bg-minilab-purple/20 text-minilab-purple px-4 py-2 rounded-full text-sm font-bold mb-6 transition-all hover:scale-105">
                ğŸ”Š AÃ§Ä±klamayÄ± Dinle
            </button>

            <p class="text-xl text-gray-600 dark:text-gray-300 mb-8 leading-relaxed max-w-2xl mx-auto">
                {{ story.description }}
            </p>

            <div class="flex justify-center gap-8 mb-8">
                <div class="text-center bg-minilab-blue-50 dark:bg-gray-700 px-6 py-4 rounded-2xl">
                    <div class="text-3xl">ğŸ“„</div>
                    <div class="text-sm text-gray-500 mt-1">{{ story.pages.count }} Sayfa</div>
                </div>
                <div class="text-center bg-minilab-yellow/20 px-6 py-4 rounded-2xl">
                    <div class="text-3xl">â±ï¸</div>
                    <div class="text-sm text-gray-500 mt-1">{{ story.estimated_time|default:5 }} Dakika</div>
                </div>
                <div class="text-center bg-minilab-green/20 px-6 py-4 rounded-2xl">
                    <div class="text-3xl">â­</div>
                    <div class="text-sm text-gray-500 mt-1">+{{ story.points|default:20 }} Puan</div>
                </div>
            </div>

            {% if story.first_page %}
            <a href="{% url 'storymode:story_page' story.slug story.first_page.order %}"
               class="page-animate inline-flex items-center gap-3 bg-gradient-to-r from-minilab-purple to-minilab-pink text-white font-display text-xl px-12 py-4 rounded-full shadow-xl hover:shadow-2xl hover:scale-105 transition-all">
                <span>ğŸ“–</span> Okumaya BaÅŸla! <span>â†’</span>
            </a>
            {% else %}
            <a href="{% url 'storymode:story_page' story.slug 1 %}"
               class="page-animate inline-flex items-center gap-3 bg-gradient-to-r from-minilab-purple to-minilab-pink text-white font-display text-xl px-12 py-4 rounded-full shadow-xl hover:shadow-2xl hover:scale-105 transition-all">
                <span>ğŸ“–</span> Okumaya BaÅŸla! <span>â†’</span>
            </a>
            {% endif %}

            <p class="text-gray-500 text-sm mt-6">
                ğŸ’¡ Ä°pucu: Kendi kararlarÄ±nÄ± vererek hikayenin gidiÅŸatÄ±nÄ± belirle!
            </p>
        </div>

        <!-- Geri Butonu -->
        <div class="text-center">
            <a href="{% url 'storymode:story_list' %}"
               class="inline-flex items-center gap-2 text-gray-500 hover:text-minilab-purple transition-colors">
                â† DiÄŸer Hikayeler
            </a>
        </div>

    </div>
</div>

<script>
function storyDetailPage() {
    return {
        speakDescription() {
            Alpine.store('app').speak('{{ story.title }}. {{ story.description }}');
        }
    }
}
</script>
{% endblock %}
