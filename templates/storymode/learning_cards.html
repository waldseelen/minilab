{% extends 'base.html' %}
{% load static %}

{% block title %}Ã–ÄŸrenme KartlarÄ± - MiniLab{% endblock %}

{% block extra_css %}
<style>
    .cards-container {
        width: 100%;
        height: calc(100vh - 200px);
        min-height: 450px;
        max-height: 600px;
    }

    /* Kategori kartlarÄ± */
    .category-card {
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .category-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        transition: left 0.5s ease;
    }

    .category-card:hover::before {
        left: 100%;
    }

    .category-card:hover {
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 20px 40px rgba(0,0,0,0.15);
    }

    /* Kategori renkleri */
    .cat-animals { --cat-color: #F59E0B; --cat-bg: #FEF3C7; }
    .cat-plants { --cat-color: #10B981; --cat-bg: #D1FAE5; }
    .cat-space { --cat-color: #6366F1; --cat-bg: #E0E7FF; }
    .cat-body { --cat-color: #EF4444; --cat-bg: #FEE2E2; }
    .cat-weather { --cat-color: #06B6D4; --cat-bg: #CFFAFE; }
    .cat-colors { --cat-color: #EC4899; --cat-bg: #FCE7F3; }
    .cat-shapes { --cat-color: #8B5CF6; --cat-bg: #EDE9FE; }
    .cat-numbers { --cat-color: #3B82F6; --cat-bg: #DBEAFE; }
    .cat-science { --cat-color: #14B8A6; --cat-bg: #CCFBF1; }
    .cat-nature { --cat-color: #22C55E; --cat-bg: #DCFCE7; }

    .category-card {
        background: var(--cat-bg);
        border: 3px solid var(--cat-color);
    }

    .category-card .icon {
        color: var(--cat-color);
    }
</style>
{% endblock %}

{% block content %}
<div class="min-h-screen py-8" x-data="learningCardsPage()">
    <div class="max-w-6xl mx-auto px-4">

        <!-- BaÅŸlÄ±k -->
        <div class="text-center mb-8">
            <div class="inline-flex items-center gap-4 bg-gradient-to-r from-minilab-green to-minilab-blue-400 text-white px-8 py-4 rounded-full shadow-2xl">
                <span class="text-5xl animate-wiggle">ğŸ“š</span>
                <div class="text-left">
                    <h1 class="font-display text-3xl">Ã–ÄŸrenme KartlarÄ±</h1>
                    <p class="text-white/80">KeÅŸfet, Ã¶ÄŸren ve eÄŸlen!</p>
                </div>
                <button @click="speakIntro()" class="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-full ml-4 transition-all hover:scale-105">
                    ğŸ”Š Dinle
                </button>
            </div>
        </div>

        <!-- Kategori SeÃ§imi veya Kartlar -->
        <template x-if="!selectedCategory">
            <div>
                <h2 class="text-2xl font-display text-center text-gray-700 dark:text-gray-200 mb-6">
                    ğŸ“‚ Bir Kategori SeÃ§
                </h2>

                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
                    <!-- Kategoriler -->
                    <div class="category-card cat-animals card-cute cursor-pointer" @click="selectCategory('animals', 'ğŸ¾ Hayvanlar')">
                        <div class="text-center py-4">
                            <div class="text-5xl mb-2">ğŸ¾</div>
                            <h3 class="font-display text-lg">Hayvanlar</h3>
                            <p class="text-sm text-gray-600 mt-1">{{ cards_by_category.animals|default:5 }} kart</p>
                        </div>
                    </div>

                    <div class="category-card cat-plants card-cute cursor-pointer" @click="selectCategory('plants', 'ğŸŒ± Bitkiler')">
                        <div class="text-center py-4">
                            <div class="text-5xl mb-2">ğŸŒ±</div>
                            <h3 class="font-display text-lg">Bitkiler</h3>
                            <p class="text-sm text-gray-600 mt-1">{{ cards_by_category.plants|default:4 }} kart</p>
                        </div>
                    </div>

                    <div class="category-card cat-space card-cute cursor-pointer" @click="selectCategory('space', 'ğŸš€ Uzay')">
                        <div class="text-center py-4">
                            <div class="text-5xl mb-2">ğŸš€</div>
                            <h3 class="font-display text-lg">Uzay</h3>
                            <p class="text-sm text-gray-600 mt-1">{{ cards_by_category.space|default:4 }} kart</p>
                        </div>
                    </div>

                    <div class="category-card cat-body card-cute cursor-pointer" @click="selectCategory('body', 'ğŸ«€ VÃ¼cut')">
                        <div class="text-center py-4">
                            <div class="text-5xl mb-2">ğŸ«€</div>
                            <h3 class="font-display text-lg">VÃ¼cut</h3>
                            <p class="text-sm text-gray-600 mt-1">{{ cards_by_category.body|default:3 }} kart</p>
                        </div>
                    </div>

                    <div class="category-card cat-weather card-cute cursor-pointer" @click="selectCategory('weather', 'ğŸŒ¤ï¸ Hava')">
                        <div class="text-center py-4">
                            <div class="text-5xl mb-2">ğŸŒ¤ï¸</div>
                            <h3 class="font-display text-lg">Hava</h3>
                            <p class="text-sm text-gray-600 mt-1">{{ cards_by_category.weather|default:3 }} kart</p>
                        </div>
                    </div>

                    <div class="category-card cat-colors card-cute cursor-pointer" @click="selectCategory('colors', 'ğŸ¨ Renkler')">
                        <div class="text-center py-4">
                            <div class="text-5xl mb-2">ğŸ¨</div>
                            <h3 class="font-display text-lg">Renkler</h3>
                            <p class="text-sm text-gray-600 mt-1">{{ cards_by_category.colors|default:4 }} kart</p>
                        </div>
                    </div>

                    <div class="category-card cat-shapes card-cute cursor-pointer" @click="selectCategory('shapes', 'ğŸ”· Åekiller')">
                        <div class="text-center py-4">
                            <div class="text-5xl mb-2">ğŸ”·</div>
                            <h3 class="font-display text-lg">Åekiller</h3>
                            <p class="text-sm text-gray-600 mt-1">{{ cards_by_category.shapes|default:4 }} kart</p>
                        </div>
                    </div>

                    <div class="category-card cat-science card-cute cursor-pointer" @click="selectCategory('science', 'ğŸ”¬ Bilim')">
                        <div class="text-center py-4">
                            <div class="text-5xl mb-2">ğŸ”¬</div>
                            <h3 class="font-display text-lg">Bilim</h3>
                            <p class="text-sm text-gray-600 mt-1">{{ cards_by_category.science|default:3 }} kart</p>
                        </div>
                    </div>

                    <div class="category-card cat-nature card-cute cursor-pointer" @click="selectCategory('nature', 'ğŸŒ¿ DoÄŸa')">
                        <div class="text-center py-4">
                            <div class="text-5xl mb-2">ğŸŒ¿</div>
                            <h3 class="font-display text-lg">DoÄŸa</h3>
                            <p class="text-sm text-gray-600 mt-1">{{ cards_by_category.nature|default:3 }} kart</p>
                        </div>
                    </div>

                    <!-- TÃ¼m Kartlar -->
                    <div class="category-card bg-gradient-to-br from-minilab-purple to-minilab-pink text-white card-cute cursor-pointer"
                         @click="selectCategory('all', 'ğŸ“š TÃ¼m Kartlar')"
                         style="border: 3px solid #8B5CF6;">
                        <div class="text-center py-4">
                            <div class="text-5xl mb-2">ğŸŒŸ</div>
                            <h3 class="font-display text-lg">Hepsini GÃ¶r</h3>
                            <p class="text-sm text-white/80 mt-1">{{ total_cards|default:20 }} kart</p>
                        </div>
                    </div>
                </div>
            </div>
        </template>

        <!-- Kartlar -->
        <template x-if="selectedCategory">
            <div>
                <!-- Geri butonu -->
                <div class="flex items-center justify-between mb-4">
                    <button @click="goBack()" class="flex items-center gap-2 text-gray-600 hover:text-minilab-purple transition-colors">
                        â† Kategorilere DÃ¶n
                    </button>
                    <h2 class="font-display text-2xl text-minilab-purple" x-text="categoryName"></h2>
                    <div></div>
                </div>

                <!-- Kart Container -->
                <div class="card-cute p-4">
                    <div id="learning-cards-container" class="cards-container">
                        <div class="flex flex-col items-center justify-center h-full gap-4">
                            <span class="text-6xl animate-bounce">ğŸ“š</span>
                            <p class="text-xl text-gray-600">Kartlar yÃ¼kleniyor...</p>
                        </div>
                    </div>
                </div>
            </div>
        </template>

        <!-- Ä°pucu -->
        <div class="mt-8 text-center">
            <div class="inline-flex items-center gap-3 bg-minilab-yellow/20 px-6 py-3 rounded-full">
                <span class="text-2xl">ğŸ’¡</span>
                <p class="text-gray-600 dark:text-gray-400">
                    <strong>Ä°pucu:</strong> Kartlara dokunarak Ã§evir ve cevabÄ± gÃ¶r! ğŸ’¡ butonuyla eÄŸlenceli bilgiler Ã¶ÄŸren!
                </p>
            </div>
        </div>

    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
<script src="{% static 'js/pixi/learning_cards.js' %}"></script>
<script>
function learningCardsPage() {
    return {
        selectedCategory: null,
        categoryName: '',
        cardsInstance: null,

        speakIntro() {
            Alpine.store('app').speak('Ã–ÄŸrenme kartlarÄ±na hoÅŸ geldin! Bir kategori seÃ§ ve kartlara tÄ±klayarak yeni ÅŸeyler Ã¶ÄŸren. KartÄ± Ã§evirmek iÃ§in Ã¼zerine dokun!');
        },

        selectCategory(category, name) {
            this.selectedCategory = category;
            this.categoryName = name;

            this.$nextTick(() => {
                this.initCards();
            });
        },

        initCards() {
            const container = document.getElementById('learning-cards-container');
            if (!container) return;

            const cards = this.getCardsForCategory(this.selectedCategory);

            this.cardsInstance = new LearningCards('learning-cards-container', {
                cards: cards,
                category: this.selectedCategory,
                autoRead: true,
                onCardComplete: (card) => {
                    console.log('Kart Ã¶ÄŸrenildi:', card);
                },
                onAllComplete: (result) => {
                    console.log('TamamlandÄ±:', result);
                }
            });
        },

        getCardsForCategory(category) {
            // Demo kart verileri
            const allCards = {
                animals: [
                    { title: 'Kelebek', emoji: 'ğŸ¦‹', category: 'animals', front_text: 'TÄ±rtÄ±ldan Ã§Ä±kan, renkli kanatlarÄ± olan bÃ¶cek hangisi?', back_text: 'Kelebek! TÄ±rtÄ±l Ã¶nce koza yapar, sonra muhteÅŸem bir kelebeÄŸe dÃ¶nÃ¼ÅŸÃ¼r.', fun_fact: 'Kelebekler kanatlarÄ±yla deÄŸil, ayaklarÄ±yla tat alÄ±r!' },
                    { title: 'ArÄ±', emoji: 'ğŸ', category: 'animals', front_text: 'Bal yapan, vÄ±zÄ±ldayan kÃ¼Ã§Ã¼k bÃ¶cek hangisi?', back_text: 'ArÄ±! ArÄ±lar Ã§iÃ§eklerden nektar toplar ve bal yapar.', fun_fact: 'Bir arÄ±, hayatÄ± boyunca sadece bir Ã§ay kaÅŸÄ±ÄŸÄ± kadar bal Ã¼retebilir!' },
                    { title: 'Yunus', emoji: 'ğŸ¬', category: 'animals', front_text: 'Denizde yaÅŸayan, zÄ±playan akÄ±llÄ± memeli hangisi?', back_text: 'Yunus! Yunuslar balÄ±k deÄŸil, memelidir.', fun_fact: 'Yunuslar uyurken beyinlerinin sadece yarÄ±sÄ± uyur!' },
                    { title: 'Penguen', emoji: 'ğŸ§', category: 'animals', front_text: 'UÃ§amayan ama Ã§ok iyi yÃ¼zen kuÅŸ hangisi?', back_text: 'Penguen! Penguenler Antarktika\'da yaÅŸar.', fun_fact: 'Baba penguenler yumurtayÄ± ayaklarÄ±nÄ±n Ã¼stÃ¼nde aylarca bekler!' },
                ],
                space: [
                    { title: 'GÃ¼neÅŸ', emoji: 'â˜€ï¸', category: 'space', front_text: 'GÃ¶kyÃ¼zÃ¼ndeki en parlak yÄ±ldÄ±z hangisi?', back_text: 'GÃ¼neÅŸ! DÃ¼nyamÄ±zÄ± Ä±sÄ±tan ve aydÄ±nlatan dev bir yÄ±ldÄ±zdÄ±r.', fun_fact: 'GÃ¼neÅŸ o kadar bÃ¼yÃ¼k ki iÃ§ine 1 milyon tane DÃ¼nya sÄ±ÄŸabilir!' },
                    { title: 'Ay', emoji: 'ğŸŒ™', category: 'space', front_text: 'Geceleri gÃ¶kyÃ¼zÃ¼nde parlayan yuvarlak cisim nedir?', back_text: 'Ay! DÃ¼nyamÄ±zÄ±n tek doÄŸal uydusudur.', fun_fact: 'Ay\'da astronotlarÄ±n ayak izleri hÃ¢lÃ¢ orada duruyor!' },
                ],
                weather: [
                    { title: 'YaÄŸmur', emoji: 'ğŸŒ§ï¸', category: 'weather', front_text: 'Bulutlardan dÃ¼ÅŸen su damlacÄ±klarÄ± nedir?', back_text: 'YaÄŸmur! Buhar bulut olur, soÄŸuyunca yaÄŸmur yaÄŸar.', fun_fact: 'Bir yaÄŸmur damlasÄ± saatte 20-35 km hÄ±zla dÃ¼ÅŸer!' },
                    { title: 'GÃ¶kkuÅŸaÄŸÄ±', emoji: 'ğŸŒˆ', category: 'weather', front_text: 'YaÄŸmurdan sonra beliren renkli yay nedir?', back_text: 'GÃ¶kkuÅŸaÄŸÄ±! GÃ¼neÅŸ Ä±ÅŸÄ±ÄŸÄ± 7 renge ayrÄ±lÄ±r.', fun_fact: 'GÃ¶kkuÅŸaÄŸÄ± renkleri: KÄ±rmÄ±zÄ±, Turuncu, SarÄ±, YeÅŸil, Mavi, Lacivert, Mor!' },
                ],
                colors: [
                    { title: 'KÄ±rmÄ±zÄ±', emoji: 'ğŸ”´', category: 'colors', front_text: 'Elma ve domates hangi renktedir?', back_text: 'KÄ±rmÄ±zÄ±! KÄ±rmÄ±zÄ± sÄ±cak bir renktir.', fun_fact: 'KÄ±rmÄ±zÄ± renk boÄŸalarÄ± kÄ±zdÄ±rmaz! BoÄŸalar renk kÃ¶rÃ¼dÃ¼r.' },
                    { title: 'Mavi', emoji: 'ğŸ”µ', category: 'colors', front_text: 'GÃ¶kyÃ¼zÃ¼ ve deniz hangi renktedir?', back_text: 'Mavi! Mavi sakin bir renktir.', fun_fact: 'Mavi, dÃ¼nyadaki insanlarÄ±n en sevdiÄŸi renktir!' },
                ],
                shapes: [
                    { title: 'ÃœÃ§gen', emoji: 'ğŸ”º', category: 'shapes', front_text: '3 kenarÄ± ve 3 kÃ¶ÅŸesi olan ÅŸekil hangisi?', back_text: 'ÃœÃ§gen! Piramitler Ã¼Ã§gen ÅŸeklindedir.', fun_fact: 'ÃœÃ§gen doÄŸadaki en gÃ¼Ã§lÃ¼ ÅŸekillerden biridir!' },
                    { title: 'Daire', emoji: 'â­•', category: 'shapes', front_text: 'KÃ¶ÅŸesi olmayan yuvarlak ÅŸekil hangisi?', back_text: 'Daire! Top ve pizza daire ÅŸeklindedir.', fun_fact: 'Daire, en Ã§ok alan sÄ±ÄŸdÄ±ran ÅŸekildir!' },
                ],
                plants: [
                    { title: 'AÄŸaÃ§', emoji: 'ğŸŒ³', category: 'plants', front_text: 'GÃ¶vdesi, dallarÄ± ve yapraklarÄ± olan bÃ¼yÃ¼k bitki nedir?', back_text: 'AÄŸaÃ§! AÄŸaÃ§lar havayÄ± temizler.', fun_fact: 'Bir aÄŸaÃ§ gÃ¼nde 4 kiÅŸiye yetecek oksijen Ã¼retir!' },
                    { title: 'Tohum', emoji: 'ğŸŒ±', category: 'plants', front_text: 'Bitkilerin iÃ§inden Ã§Ä±ktÄ±ÄŸÄ± kÃ¼Ã§Ã¼k ÅŸey nedir?', back_text: 'Tohum! Her bitki bir tohumdan bÃ¼yÃ¼r.', fun_fact: 'En bÃ¼yÃ¼k tohum 25 kg aÄŸÄ±rlÄ±ÄŸÄ±nda olabilir!' },
                ],
                body: [
                    { title: 'Kalp', emoji: 'â¤ï¸', category: 'body', front_text: 'VÃ¼cudumuzda kanÄ± pompalayan organ hangisi?', back_text: 'Kalp! GÃ¼nde 100.000 kez atar.', fun_fact: 'Kalbinin bÃ¼yÃ¼klÃ¼ÄŸÃ¼ senin yumruÄŸun kadar!' },
                    { title: 'GÃ¶z', emoji: 'ğŸ‘ï¸', category: 'body', front_text: 'Hangi organÄ±mÄ±zla gÃ¶rÃ¼rÃ¼z?', back_text: 'GÃ¶z! GÃ¶zler Ä±ÅŸÄ±ÄŸÄ± algÄ±lar.', fun_fact: 'GÃ¶zlerin saniyede 3 kez kÄ±rpÄ±lÄ±r!' },
                ],
                science: [
                    { title: 'Dinozor', emoji: 'ğŸ¦•', category: 'science', front_text: 'Milyonlarca yÄ±l Ã¶nce yaÅŸamÄ±ÅŸ dev sÃ¼rÃ¼ngenler kimler?', back_text: 'Dinozorlar! 65 milyon yÄ±l Ã¶nce yok oldular.', fun_fact: 'BazÄ± dinozorlar tavuk kadar kÃ¼Ã§Ã¼ktÃ¼!' },
                    { title: 'MÄ±knatÄ±s', emoji: 'ğŸ§²', category: 'science', front_text: 'Demir ve Ã§eliÄŸi Ã§eken Ã¶zel taÅŸ nedir?', back_text: 'MÄ±knatÄ±s! Metal nesneleri Ã§eker.', fun_fact: 'DÃ¼nya\'nÄ±n kendisi de dev bir mÄ±knatÄ±s gibidir!' },
                ],
                nature: [
                    { title: 'Su DÃ¶ngÃ¼sÃ¼', emoji: 'ğŸ’§', category: 'nature', front_text: 'Suyun buharlaÅŸÄ±p tekrar yaÄŸmur olmasÄ±na ne denir?', back_text: 'Su dÃ¶ngÃ¼sÃ¼! Bu dÃ¶ngÃ¼ hiÃ§ durmaz.', fun_fact: 'Åu an iÃ§tiÄŸin su dinozorlarÄ±n da iÃ§tiÄŸi suyla aynÄ±!' },
                    { title: 'Fotosentez', emoji: 'ğŸŒ¿', category: 'nature', front_text: 'Bitkilerin gÃ¼neÅŸ Ä±ÅŸÄ±ÄŸÄ±yla besin yapmasÄ±na ne denir?', back_text: 'Fotosentez! Bitkiler oksijen Ã¼retir.', fun_fact: 'Yapraklar yeÅŸil Ã§Ã¼nkÃ¼ klorofil yeÅŸil Ä±ÅŸÄ±ÄŸÄ± yansÄ±tÄ±r!' },
                ],
            };

            if (category === 'all') {
                return Object.values(allCards).flat();
            }

            return allCards[category] || allCards.animals;
        },

        goBack() {
            if (this.cardsInstance) {
                this.cardsInstance.destroy();
                this.cardsInstance = null;
            }
            this.selectedCategory = null;
            this.categoryName = '';
        }
    }
}
</script>
{% endblock %}
