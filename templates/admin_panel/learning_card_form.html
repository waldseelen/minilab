{% extends 'admin_panel/base.html' %}

{% block page_title %}{% if card %}KartÄ± DÃ¼zenle{% else %}Yeni Bilgi KartÄ±{% endif %}{% endblock %}
{% block page_subtitle %}{% if card %}{{ card.title }}{% else %}Yeni bir Ã¶ÄŸrenme kartÄ± oluÅŸtur{% endif %}{% endblock %}

{% block admin_content %}
<div class="max-w-4xl">

    <form method="post" class="space-y-6">
        {% csrf_token %}

        <!-- Temel Bilgiler -->
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg">
            <h2 class="font-display text-xl text-gray-800 dark:text-white mb-6 flex items-center gap-2">
                ğŸƒ Kart Bilgileri
            </h2>

            <div class="grid md:grid-cols-2 gap-6">
                <!-- Deney SeÃ§imi -->
                <div>
                    <label class="block text-sm font-bold text-gray-600 dark:text-gray-300 mb-2">
                        ğŸ”¬ Deney *
                    </label>
                    <select name="experiment" required
                            class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 focus:border-minilab-blue-400 focus:ring-0 transition">
                        <option value="">Deney seÃ§in...</option>
                        {% for exp in experiments %}
                        <option value="{{ exp.id }}" {% if card and card.experiment_id == exp.id %}selected{% endif %}>
                            {{ exp.category.icon }} {{ exp.category.name }} â†’ {{ exp.title }}
                        </option>
                        {% endfor %}
                    </select>
                </div>

                <!-- BaÅŸlÄ±k -->
                <div>
                    <label class="block text-sm font-bold text-gray-600 dark:text-gray-300 mb-2">
                        ğŸ“ BaÅŸlÄ±k *
                    </label>
                    <input type="text" name="title" value="{{ card.title|default:'' }}" required
                           placeholder="Ã–rn: Su DÃ¶ngÃ¼sÃ¼ Nedir?"
                           class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 focus:border-minilab-blue-400 focus:ring-0 transition">
                </div>
            </div>
        </div>

        <!-- Kart Ä°Ã§erikleri -->
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg">
            <h2 class="font-display text-xl text-gray-800 dark:text-white mb-6 flex items-center gap-2">
                ğŸ”„ Kart Ä°Ã§eriÄŸi
            </h2>

            <div class="grid md:grid-cols-2 gap-6">
                <!-- Ã–n YÃ¼z -->
                <div>
                    <label class="block text-sm font-bold text-gray-600 dark:text-gray-300 mb-2">
                        ğŸ“– Ã–n YÃ¼z (Soru/Konu) *
                    </label>
                    <textarea name="front_content" required rows="5"
                              placeholder="KartÄ±n Ã¶n yÃ¼zÃ¼nde gÃ¶rÃ¼necek metin. Ã–rn: Su nereden gelir ve nereye gider?"
                              class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 focus:border-minilab-blue-400 focus:ring-0 transition resize-none">{{ card.front_content|default:'' }}</textarea>
                    <p class="text-xs text-gray-500 mt-1">Ã‡ocuÄŸun merak edeceÄŸi, Ã¶ÄŸrenmek isteyeceÄŸi bir soru veya konu yazÄ±n.</p>
                </div>

                <!-- Arka YÃ¼z -->
                <div>
                    <label class="block text-sm font-bold text-gray-600 dark:text-gray-300 mb-2">
                        ğŸ’¡ Arka YÃ¼z (Cevap/AÃ§Ä±klama) *
                    </label>
                    <textarea name="back_content" required rows="5"
                              placeholder="KartÄ±n arka yÃ¼zÃ¼nde gÃ¶rÃ¼necek metin. Ã–rn: Su, bulutlardan yaÄŸmur olarak yere dÃ¼ÅŸer..."
                              class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 focus:border-minilab-blue-400 focus:ring-0 transition resize-none">{{ card.back_content|default:'' }}</textarea>
                    <p class="text-xs text-gray-500 mt-1">Basit, anlaÅŸÄ±lÄ±r ve eÄŸlenceli bir aÃ§Ä±klama yazÄ±n. 4-6 yaÅŸ iÃ§in uygun olmalÄ±.</p>
                </div>
            </div>
        </div>

        <!-- Ayarlar -->
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg">
            <h2 class="font-display text-xl text-gray-800 dark:text-white mb-6 flex items-center gap-2">
                âš™ï¸ Ayarlar
            </h2>

            <div class="grid md:grid-cols-2 gap-6">
                <!-- SÄ±ralama -->
                <div>
                    <label class="block text-sm font-bold text-gray-600 dark:text-gray-300 mb-2">
                        ğŸ“Š SÄ±ralama
                    </label>
                    <input type="number" name="order" value="{{ card.order|default:0 }}" min="0"
                           class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 focus:border-minilab-blue-400 focus:ring-0 transition">
                    <p class="text-xs text-gray-500 mt-1">DÃ¼ÅŸÃ¼k sayÄ±lar Ã¶nce gÃ¶sterilir.</p>
                </div>

                <!-- EÄŸlenceli Ä°pucu -->
                <div>
                    <label class="block text-sm font-bold text-gray-600 dark:text-gray-300 mb-2">
                        ğŸ¯ EÄŸlenceli Ä°pucu (Opsiyonel)
                    </label>
                    <input type="text" name="fun_fact" value="{{ card.fun_fact|default:'' }}"
                           placeholder="Ã–rn: Biliyor musun? Bir bulut tonlarca su taÅŸÄ±r!"
                           class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 focus:border-minilab-blue-400 focus:ring-0 transition">
                </div>
            </div>
        </div>

        <!-- Ã–nizleme -->
        <div class="bg-gradient-to-br from-purple-100 to-pink-100 dark:from-purple-900/30 dark:to-pink-900/30 rounded-2xl p-6">
            <h2 class="font-display text-xl text-gray-800 dark:text-white mb-4 flex items-center gap-2">
                ğŸ‘ï¸ Ã–nizleme
            </h2>

            <div class="flex justify-center">
                <div class="w-72 h-48 bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 flex flex-col items-center justify-center text-center border-4 border-dashed border-purple-300">
                    <span class="text-4xl mb-2">ğŸƒ</span>
                    <h3 class="font-display text-lg text-purple-600" id="preview-title">Kart BaÅŸlÄ±ÄŸÄ±</h3>
                    <p class="text-sm text-gray-500 mt-2" id="preview-content">Kart iÃ§eriÄŸi burada gÃ¶rÃ¼necek...</p>
                </div>
            </div>
        </div>

        <!-- Butonlar -->
        <div class="flex justify-between items-center">
            <a href="{% url 'admin_panel:learning_cards' %}"
               class="px-6 py-3 rounded-xl bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 font-bold transition">
                â† Geri
            </a>

            <button type="submit"
                    class="px-8 py-3 rounded-xl bg-gradient-to-r from-minilab-yellow to-minilab-orange-400 text-white font-bold shadow-lg hover:shadow-xl transition hover:scale-105">
                ğŸ’¾ {% if card %}GÃ¼ncelle{% else %}Kaydet{% endif %}
            </button>
        </div>

    </form>

</div>

<script>
// CanlÄ± Ã¶nizleme
document.querySelector('input[name="title"]').addEventListener('input', function() {
    document.getElementById('preview-title').textContent = this.value || 'Kart BaÅŸlÄ±ÄŸÄ±';
});

document.querySelector('textarea[name="front_content"]').addEventListener('input', function() {
    document.getElementById('preview-content').textContent = this.value || 'Kart iÃ§eriÄŸi burada gÃ¶rÃ¼necek...';
});
</script>
{% endblock %}
